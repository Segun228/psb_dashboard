# üìä PSB Analytics Dashboard

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π.

![Grafana](https://img.shields.io/badge/Grafana-F2F4F8?style=for-the-badge&logo=grafana&logoColor=orange)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-2CA5E0?style=for-the-badge&logo=docker&logoColor=white)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ Docker Compose

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```bash
git clone <repository-url>
cd psb_dashboard
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# PostgreSQL Database
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=analytics_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgrespassword

# Grafana
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=admin123

# External Database (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
DATABASE_URL=postgresql://neondb_owner:pass@host.neon.tech
```

### 3. –ó–∞–ø—É—Å–∫ –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å
docker-compose ps

# –ñ–¥–∏ 30-60 —Å–µ–∫—É–Ω–¥ –ø–æ–∫–∞ –≤—Å—ë –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
```

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑—É
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
cd scripts
pip install -r requirements.txt

# –ó–∞–≥—Ä—É–∑–∏ Excel —Ñ–∞–π–ª –≤ PostgreSQL
python excel_loader.py ../data/data.xlsx --all-sheets
```

### 5. –û—Ç–∫—Ä–æ–π –¥–∞—à–±–æ—Ä–¥—ã
- **Grafana:** http://localhost:3000
  - –õ–æ–≥–∏–Ω: `admin`
  - –ü–∞—Ä–æ–ª—å: `admin123`

- **pgAdmin:** http://localhost:5050
  - –õ–æ–≥–∏–Ω: `admin@analytics.com`
  - –ü–∞—Ä–æ–ª—å: `pgadmin123`

## üê≥ –ó–∞–ø—É—Å–∫–∞–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã

Docker Compose –ø–æ–¥–Ω–∏–º–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É:

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------|------------|
| **Grafana** | 3000 | üìä –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è |
| **PostgreSQL** | 5432 | üóÑÔ∏è –û—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| **pgAdmin** | 5050 | üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö |
| **Metabase** | 3001 | üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| **Superset** | 3002 | üìà –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

## üìä –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ –¥–∞—à–±–æ—Ä–¥–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **–§–û–¢** - –∞–Ω–∞–ª–∏–∑ —Ñ–æ–Ω–¥–∞ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞
- **–¢–µ–∫—É—á–µ—Å—Ç—å** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞  
- **–ù–∞–ª–æ–≥–∏** - —Ñ–∏—Å–∫–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- **–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å** - –∫–∞–¥—Ä–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –¢–∏–ø—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
- üìà **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã** - —Ñ–∞–∫—Ç vs –ø–ª–∞–Ω
- üéØ **KPI –¥–∞—à–±–æ—Ä–¥—ã** - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–π
- üìä **Bar gauges** - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –≤–∞—Ä–∏–∞—Ü–∏–∏
- üîÑ **Gauge charts** - –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker-compose restart grafana

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs grafana
docker-compose logs postgres

# –û–±–Ω–æ–≤–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose pull
docker-compose up -d
```

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ Excel —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–∞–±–ª–∏—Ü—ã:
- **metrics_data** - –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- **months_lookup** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Å—è—Ü–µ–≤  
- **metrics_metadata** - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫

## üìà –ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏–∑–∞

### –ß–µ—Ä–µ–∑ Grafana
1. –û—Ç–∫—Ä–æ–π http://localhost:3000
2. –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–∏–ª—å—Ç—Ä—ã:
   - **Metric** - –≤—ã–±–æ—Ä –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è (–§–û–¢, –¢–µ–∫—É—á–µ—Å—Ç—å, etc.)
   - **Year** - –≤—ã–±–æ—Ä –≥–æ–¥–∞
   - **Metric Type** - —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (–§–∞–∫—Ç/–ü–ª–∞–Ω)

### –ß–µ—Ä–µ–∑ pgAdmin
1. –û—Ç–∫—Ä–æ–π http://localhost:5050
2. –î–æ–±–∞–≤—å —Å–µ—Ä–≤–µ—Ä:
   - Host: `postgres`
   - User: `postgres` 
   - Password: `postgrespassword`
3. –í—ã–ø–æ–ª–Ω—è–π SQL –∑–∞–ø—Ä–æ—Å—ã –Ω–∞–ø—Ä—è–º—É—é

## üöÄ –ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ–π

–ü—Ä–æ–µ–∫—Ç —Ç–∞–∫–∂–µ –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω:

```bash
# –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Å–±–æ—Ä–∫–∞
docker-compose -f docker-compose.prod.yml up -d

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –≥–æ—Ç–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥:
# https://psb-dashboard.onrender.com
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–æ—Å—Ç–æ –ø–æ–ª–æ–∂–∏ –Ω–æ–≤—ã–π Excel –≤ data/
# –∏ –≤—ã–ø–æ–ª–Ω–∏:
python scripts/excel_loader.py data/new_data.xlsx --all-sheets
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã
```bash
# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –¥–∞—à–±–æ—Ä–¥ –∏–∑ Grafana
# –ü–æ–ª–æ–∂–∏ JSON –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –æ–±—Ä–∞–∑
docker-compose build grafana
docker-compose up -d
```

## ‚ùó –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –°–µ—Ä–≤–∏—Å—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
docker-compose logs

# –ü—Ä–æ–≤–µ—Ä—å –∑–∞–Ω—è—Ç—ã –ª–∏ –ø–æ—Ä—Ç—ã
netstat -an | grep 3000

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –æ–±—Ä–∞–∑—ã
docker-compose build --no-cache
docker-compose up -d
```

### –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker-compose exec postgres psql -U postgres -d analytics_db -c "SELECT version();"

# –ü—Ä–æ–≤–µ—Ä—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
docker-compose exec postgres psql -U postgres -d analytics_db -c "\dt"
```

---

**‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–µ–∑–µ–Ω - –ø–æ—Å—Ç–∞–≤—å –∑–≤–µ–∑–¥—É!**

*–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π - –æ—Ç–∫—Ä–æ–π issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.*
